# Порты и сохранение данных

## Порты

Ранее мы использовали контейнеры только путем запуска команд в них (запуская контейнер в интерактивном режиме или сразу запуская нужную команду). Этот способ может использоваться в учебных целях или для запуска консольных команд.

Но, если нам нужно настроить сервер, который будет получать запросы от пользователя и отправлять ему ответ, то нужно использовать другой подход.

К контейнеру, как и к виртуальной машине, можно обратиться через определенный порт. 

По умолчанию, когда контейнер запускается командой `docker create` или `docker run`, то ни один из его портов не открыт внешнему миру. Чтобы это исправить нужно явно указать нужный порт в контейнере и порт хост-машины, с которым он будет связан.

Делается это с помощью опций `--publish` или `-p`.

Например, `-p 8000:80` - свяжет порт `8000` хост-машины и `80-й` порт контейнера.

Если нужно открыть несколько портов, то нужно несколько раз указать эту опцию:
`-p 8000:80 -p 8443:443`.

Если указанный порт хост-машины занят, то получим соответствующую ошибку - `Bind for 0.0.0.0:8000 failed: port is already allocated`.

Перейдем к практике и запустим контейнер Nginx с открытием порта:

```bash
docker run --rm -d --name edge -p 8000:80 nginx:1.23
```

Теперь запросим список запущенных контейнеров с именем `edge`:
```bash
docker ps --filter "name=edge"
```
Обратите внимание на колонку PORTS:
```
0.0.0.0:8000->80/tcp, :::8000->80/tcp
```
В ней указано, что 8000-й порт хост-машины, связан с 80-м портом контейнера. А именно 80-й порт по-умолчанию слушает Nginx. 

Чтобы отправить запрос в Nginx через 80-й порт, нужно отправить его на 8000-й порт хост-машины:
```bash
curl 0.0.0.0:8000
```
В ответ получим HTML, который отдает Nginx.

Также можно обращаться к хост-машине такими способами: `curl 127.0.0.1:8000` или `curl localhost:8000`.

Не забываем останавливать контейнер после того, как он больше не нужен:

```bash
docker stop edge
```

## Сохранение данных
